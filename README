README file for bbgen version 1.6
=================================

bbgen is a drop-in replacement for the bb-display.sh script that 
ships with the Big Brother monitoring tool.

It can also replace part of the LARRD tool that is often used
with Big Brother.

bbtest-web, bbnethosts and bbgmchosts are utilities that can
replace part of the bb-network.sh network test utility in
Big Brother. See README.bb-network for details.

bbgen, bbtest-web, bbnethosts and bbgmchosts and sources are 
Copyright (C) 2002-2003, Henrik Storner <henrik@storner.dk> 
All files are released under the GNU General Public License, 
version 2. See the file COPYING for details.

A site running this software can be seen at http://www.hswn.dk/bb/


Features
--------

The main feature of bbgen is speed. My BB installation currently
has about 250 hosts, spread over 50 pages and subpages. The time
to generate the pages with bb-display.sh was about 12 minutes;
bbgen does it in less than 5 seconds.

The pages generated by bbgen should be similar to what you get
with bb-display.sh from BB version 1.9c.

bbgen also supports the generation of files for the LARRD
graphics plugin for Big Brother (http://www.packetpushers.com/larrd).
LARRD uses a Perl script to generate stub HTML pages on the
Big Brother display - bbgen can generate these pages, so you 
do not need to run the larrd-html.pl script. This gives the
other LARRD scripts more time to handle the import of data
for your trend graphs, instead of wasting it with generation
of the web pages. See the "LARRD support" section below.

There are a couple of non-standard tags in bb-hosts that bbgen
will recognize. See the "README.bbhosts" file for a detailed 
description of these.


Requirements
------------

A working Big Brother installation. Get BB up and running first,
then you can drop in bbgen to speed up things.


Compatibility
-------------

bbgen is intended to be a drop-in replacement for the bb-display.sh
script in Big Brother version 1.9c. 

If you enable bbgen's LARRD support, you will need to change a few
of the Big Brother files - see "LARRD support" below.

The only known difference is that pages with both hosts and subpages
have the hosts first in standard Big Brother; bbgen by default places 
the hosts last (after the subpages). If you want the standard BB
behaviour, use the "--pages-last" option.

The following features in bb-display.sh are not currently implemented
in bbgen:

* "group" directives in bb-hosts are handled as "group-compress".
  I currently have no plans to support the simple "group"
  directive.

* Modem banks are not handled at all by bbgen. This directive
  is simply ignored - if you have a pressing need for bbgen
  to support it, let me know.


Installation
------------

See the INSTALL file.


Special display for newly changed items (--recentgifs option)
-------------------------------------------------------------

bbgen supports the use of an alternate set of BB red/yellow/green
icons for status items, that have changed within the past 24 
hours.

To enable this, put the extra set of icons into the $BBHOME/www/gifs/
directory as "red-recent.gif", "green-recent.gif" etc, and run
bbgen with the "--recentgifs" option. Several icon sets are
available from www.deadcat.net.au.

I find it quite handy to see what systems have had any problems
recently.

bbgen will also put the "status unchanged" time into the ALT
tag for the icon. This means that many browsers will display
a small popup-window with this information, if you let the
mouse rest over the icon for a second or two.


LARRD support (--larrd option)
------------------------------

bbgen has built-in support for handling some of the trivial tasks
that the LARRD trend-graphing package has: Generation of the
pseudo BB log-files for the "larrd" column that link to the 
LARRD page for each host, and generation of those webpages
with links to the various trend-graphs that LARRD provides.

This is disabled by default - to enable it, you must run bbgen
with the "--larrd" option. If you prefer to have your LARRD
columns named something other than "larrd" - mine is called
"graphs" - you can specify the column name as "--larrd=graphs".

See the INSTALL file for details on how you enable this. You
do need to make some modifications to standard BB+LARRD files.

Enabling the LARRD support does increase the run-time of bbgen.
On my system, it approximately doubles the time to run bbgen,
compared to the time it takes without LARRD support. It is still
much faster than the standard bb-display.sh and larrd-html.pl
scripts, though.


BB Info column (--info option)
------------------------------

With a large number of systems - and in my case, the same systems tested
from multiple network locations - it can get to be a bit difficult to
remember the configuration details for all of the hosts. And having to
grep through bb-hosts is annoying when you already have the web page
in your browser.

If you run bbgen with the "--info" option, it will generate an
always-green column for all hosts, where the actual configuration
for that host is displayed. This includes the hostname, IP-adress,
whether network tests use the hostname or IP-adress, if the host 
is a dialup host, if it is checked with ping, the web URL's
checked for this host (if any), and all of the other configuration
information used by Big Brother. If you use any of my non-standard
bb-hosts extensions (see the README.bbhosts file), these will also 
show up here.

The "info" column is always included in the bb2.html and in the
non-standard bbnk.html page, so the information is available to
the people troubleshooting a problem with a service or host.

As with the LARRD option, generating the info-column pages do add
to the time it takes to run bbgen. The info column pages are only 
updated when the bb-hosts, bbwarnsetup.cfg or bbwarnrules.cfg
files change - and at most once every 5 minutes.

As with the LARRD column, the "info" column name can be specified in
the "--info=COLUMNNAME" option.


Bugs
----

bbgen is very new. It is currently in use on two systems I run:
One very large installation, and one very small installation.
It works for me, and I think I have taken care of all the 
little details, but do not be surprised if it crashes when you
try to run it.

bbgen now (from version 1.4) checks that all needed environment
variables have been defined, and will complain if any are 
missing. You must have loaded all of the BB environment:

    BBHOME=/path/to/bb/home
    export BBHOME
    . $BBHOME/etc/bbdef.sh

You should also check that you have write access to the 
BBTMP and BBWEB directories.

If it still fails, feel free to debug the problem and send me
patches :-) Or if your C coding is a bit rusty, e-mail we and
I'll see if I can help you track down the problem. I will 
probably need a copy of the contents of your bb-hosts file,
and the contents of the bbvar/logs/ directory:

	tar cvf /tmp/bbgendata.tar $BBHOSTS $BBLOGS/
	gzip /tmp/bbgendata.tar


Planned improvements
--------------------

See the "TODO" file.



Henrik Storner <henrik@storner.dk>
Feb 10, 2003

